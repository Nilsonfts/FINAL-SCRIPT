# üìä –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –°–∏—Å—Ç–µ–º–∞ –ê–Ω–∞–ª–∏—Ç–∏–∫–∏ v2.0

–ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–æ–≤ –¥–ª—è Google Sheets —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π OpenAI GPT.

## üéØ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
- **`_Config.gs`** ‚Äî –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- **`_Utils.gs`** ‚Äî –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –æ—Ç—á—ë—Ç–æ–≤  
- **–ï–¥–∏–Ω–æ–µ –º–µ–Ω—é** ‚Äî –í—Å–µ –æ—Ç—á—ë—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

### ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- ‚ùå –ë–æ–ª—å—à–µ –Ω–µ—Ç –æ—à–∏–±–æ–∫ "Identifier has already been declared"
- ‚ùå –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –º–µ–∂–¥—É —Å–∫—Ä–∏–ø—Ç–∞–º–∏
- ‚ùå –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π

### ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- üîß –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å —á—ë—Ç–∫–∏–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- üé® –ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è (PT Sans)
- üìä –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è GPT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- üîÑ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
üìä –°–∏—Å—Ç–µ–º–∞ –ê–Ω–∞–ª–∏—Ç–∏–∫–∏ v2.0
‚îú‚îÄ‚îÄ _Config.gs              ‚Üê –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ _Utils.gs               ‚Üê –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ + –º–µ–Ω—é
‚îú‚îÄ‚îÄ MainScript.gs           ‚Üê –û—Å–Ω–æ–≤–Ω–æ–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ RefusalAnalysis.gs      ‚Üê –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω –æ—Ç–∫–∞–∑–æ–≤  
‚îú‚îÄ‚îÄ ChannelAnalysis.gs      ‚Üê –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞–Ω–∞–ª–æ–≤
‚îî‚îÄ‚îÄ [–û—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á—ë—Ç—ã]      ‚Üê –ñ–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞
```javascript
// –í –†–µ–¥–∞–∫—Ç–æ—Ä–µ —Å–∫—Ä–∏–ø—Ç–æ–≤: –ü—Ä–æ–µ–∫—Ç ‚Üí –°–≤–æ–π—Å—Ç–≤–∞ ‚Üí –°–≤–æ–π—Å—Ç–≤–∞ —Å–∫—Ä–∏–ø—Ç–∞
// –î–æ–±–∞–≤–∏—Ç—å:
OPENAI_API_KEY = –≤–∞—à_–∫–ª—é—á_openai
```

### 2. –ò–º–ø–æ—Ä—Ç —Ñ–∞–π–ª–æ–≤
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `_Config.gs` –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å–∫—Ä–∏–ø—Ç–∞
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `_Utils.gs` –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å–∫—Ä–∏–ø—Ç–∞  
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –æ—Ç—á—ë—Ç–æ–≤

### 3. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
1. –û–±–Ω–æ–≤–∏—Ç–µ `buildWorkingFromFive()` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
2. –û—Ç–∫—Ä–æ–π—Ç–µ Google –¢–∞–±–ª–∏—Ü—É ‚Äî –ø–æ—è–≤–∏—Ç—Å—è –º–µ–Ω—é **"üìä –í—Å–µ –û—Ç—á—ë—Ç—ã"**
3. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –æ—Ç—á—ë—Ç –∏–∑ –º–µ–Ω—é

## üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π

### –ï–¥–∏–Ω–æ–µ –º–µ–Ω—é "üìä –í—Å–µ –û—Ç—á—ë—Ç—ã"

#### üîÑ –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Ç—á—ë—Ç—ã:
- **–û–±–Ω–æ–≤–∏—Ç—å –†–ê–ë–û–ß–ò–ô –ê–ú–û** ‚Äî –°–±–æ—Ä –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω –æ—Ç–∫–∞–∑–æ–≤** ‚Äî AI –∞–Ω–∞–ª–∏–∑ –æ—Ç–∫–∞–∑–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤  
- **–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞–Ω–∞–ª–æ–≤** ‚Äî –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–∞–Ω–∞–ª–æ–≤
- **–ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤—ã—Ö –∫–∞—Å–∞–Ω–∏–π** ‚Äî First-touch –∞—Ç—Ä–∏–±—É—Ü–∏—è
- **–°–≤–æ–¥–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ AMO** ‚Äî –û–±—â–∏–π –¥–∞—à–±–æ—Ä–¥

#### üìä –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:
- **–ö–æ–ª–ª-—Ç—Ä–µ–∫–∏–Ω–≥** ‚Äî –ê–Ω–∞–ª–∏–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –∑–≤–æ–Ω–∫–æ–≤
- **–õ–∏–¥—ã –ø–æ –∫–∞–Ω–∞–ª–∞–º** ‚Äî –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
- **–°–∫–≤–æ–∑–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** ‚Äî End-to-end –º–µ—Ç—Ä–∏–∫–∏
- **–ê–Ω–∞–ª–∏–∑ –∫–∞–Ω–∞–ª–æ–≤ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è** ‚Äî ROI –ø–æ –∫–∞–Ω–∞–ª–∞–º

#### ‚è∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏:
- **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –µ–∂–µ—á–∞—Å–Ω—ã–µ** ‚Äî –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –æ—Ç—á—ë—Ç–æ–≤
- **–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã** ‚Äî –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- **–ü–æ–∫–∞–∑–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã** ‚Äî –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `_Config.gs`:

```javascript
const CONFIG = {
  // –û–±—â–∏–µ
  API_KEY: PropertiesService.getScriptProperties().getProperty('OPENAI_API_KEY'),
  TIMEZONE: 'Europe/Moscow',
  FONT: 'PT Sans',
  
  // –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫–∞–∑–æ–≤  
  refusals: {
    SOURCE_SHEET: '–†–ê–ë–û–ß–ò–ô –ê–ú–û',
    OUTPUT_SHEET: '–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞–∑–æ–≤', 
    GPT_MODEL: 'gpt-4o',
    FALLBACK_MODEL: 'gpt-4o-mini'
  },
  
  // –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞–Ω–∞–ª–æ–≤
  channels: {
    SOURCE_SHEET: '–†–ê–ë–û–ß–ò–ô –ê–ú–û',
    OUTPUT_SHEET: '–°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó',
    CHART_START_DATE: '2025-04-01'
  }
  
  // ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
};
```

## ü§ñ GPT –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã:
```javascript
CONFIG.prompts = {
  refusalAnalysis: `–¢—ã ‚Äî –≤–µ–¥—É—â–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫ –ø—Ä–æ–¥–∞–∂...`,
  channelAnalysis: `–¢—ã ‚Äî —Å—Ç–∞—Ä—à–∏–π –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥-–∞–Ω–∞–ª–∏—Ç–∏–∫...`, 
  firstTouchAnalysis: `–¢—ã ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É...`
};
```

### –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑–æ–≤–∞:
```javascript
const gptResult = await callOpenAI(prompt, {
  systemPrompt: CONFIG.prompts.refusalAnalysis,
  model: 'gpt-4o',
  fallbackModel: 'gpt-4o-mini',
  temperature: 0.4
});
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –æ—Ç—á—ë—Ç–æ–≤

### –®–∞–±–ª–æ–Ω –Ω–æ–≤–æ–≥–æ –æ—Ç—á—ë—Ç–∞:
```javascript
function buildMyNewReport() {
  const CFG = getModuleConfig('myReport'); // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ —Ü–µ–Ω—Ç—Ä–∞
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  
  // 1) –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
  const { header, rows } = readSheet(ss, CFG.SOURCE_SHEET);
  
  // 2) –ü–æ–∏—Å–∫ –∫–æ–ª–æ–Ω–æ–∫
  const indices = findColumns(header, {
    date: ['–î–∞—Ç–∞', 'Date'],
    status: ['–°—Ç–∞—Ç—É—Å', 'Status']  
  });
  
  // 3) –û–±—Ä–∞–±–æ—Ç–∫–∞
  const analysis = processData(rows, indices);
  
  // 4) GPT –∞–Ω–∞–ª–∏–∑
  const insights = await callOpenAI(buildPrompt(analysis), {
    systemPrompt: CONFIG.prompts.myReport
  });
  
  // 5) –í—ã–≤–æ–¥
  renderReport(ss, CFG, analysis, insights);
}
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –≤ `_Utils.gs`:

#### –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:
- `readSheet(ss, sheetName)` ‚Äî –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –ª–∏—Å—Ç–∞
- `findColumns(header, columnMap)` ‚Äî –ü–æ–∏—Å–∫ –∫–æ–ª–æ–Ω–æ–∫ –ø–æ —Å–∏–Ω–æ–Ω–∏–º–∞–º

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:
- `normalizeStatus(status)` ‚Äî –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
- `cleanPhone(phone)` ‚Äî –û—á–∏—Å—Ç–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
- `toNumber(value)` ‚Äî –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —á–∏—Å–ª–æ
- `groupBy(array, keyFn)` ‚Äî –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

#### –í—ã–≤–æ–¥:
- `writeTable(sheet, row, col, header, data)` ‚Äî –ö—Ä–∞—Å–∏–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- `createSection(sheet, row, col, title)` ‚Äî –°–µ–∫—Ü–∏–∏ –æ—Ç—á—ë—Ç–æ–≤
- `autoResizeColumns(sheet)` ‚Äî –ê–≤—Ç–æ—à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫

#### –¢—Ä–∏–≥–≥–µ—Ä—ã:
- `setHourlyTrigger(functionName)` ‚Äî –ï–∂–µ—á–∞—Å–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä
- `setDailyTrigger(functionName, hour)` ‚Äî –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä  
- `removeTrigger(functionName)` ‚Äî –£–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞

## üìà –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ—Ç—á—ë—Ç—ã

| –û—Ç—á—ë—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|---------|----------|
| –†–ê–ë–û–ß–ò–ô –ê–ú–û | ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω | –û—Å–Ω–æ–≤–Ω–æ–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö |
| –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫–∞–∑–æ–≤ | ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω | GPT –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω –æ—Ç–∫–∞–∑–æ–≤ |
| –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ | ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω | –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–∞–Ω–∞–ª–æ–≤ |
| –ü–µ—Ä–≤—ã–µ –∫–∞—Å–∞–Ω–∏—è | ‚è≥ –í –æ—á–µ—Ä–µ–¥–∏ | First-touch –∞—Ç—Ä–∏–±—É—Ü–∏—è |
| –ö–æ–ª–ª-—Ç—Ä–µ–∫–∏–Ω–≥ | ‚è≥ –í –æ—á–µ—Ä–µ–¥–∏ | –ê–Ω–∞–ª–∏–∑ –∑–≤–æ–Ω–∫–æ–≤ |
| –°–≤–æ–¥–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ | ‚è≥ –í –æ—á–µ—Ä–µ–¥–∏ | –û–±—â–∏–π –¥–∞—à–±–æ—Ä–¥ |
| –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ –∫–∞–Ω–∞–ª—ã | ‚è≥ –í –æ—á–µ—Ä–µ–¥–∏ | ROI –∞–Ω–∞–ª–∏–∑ |
| –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ | ‚è≥ –í –æ—á–µ—Ä–µ–¥–∏ | –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ |

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –§–∞–∑–∞ 1: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ ‚úÖ
- [x] –°–æ–∑–¥–∞–Ω–∏–µ _Config.gs
- [x] –°–æ–∑–¥–∞–Ω–∏–µ _Utils.gs  
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ MainScript.gs
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ RefusalAnalysis.gs
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ChannelAnalysis.gs

### –§–∞–∑–∞ 2: –û—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á—ë—Ç—ã ‚è≥
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –ê–Ω–∞–ª–∏–∑ –ü–µ—Ä–≤—ã—Ö –ö–∞—Å–∞–Ω–∏–π
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –ö–æ–ª–ª-—Ç—Ä–µ–∫–∏–Ω–≥  
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –°–≤–æ–¥–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á—ë—Ç—ã

### –§–∞–∑–∞ 3: –£–ª—É—á—à–µ–Ω–∏—è üîÆ
- [ ] –î–∞—à–±–æ—Ä–¥ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
- [ ] Email —Ä–∞—Å—Å—ã–ª–∫–∞ –æ—Ç—á—ë—Ç–æ–≤
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤

## üÜò Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

**"Function not found"**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `_Utils.gs` –∑–∞–≥—Ä—É–∂–µ–Ω –ø–µ—Ä–≤—ã–º
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π –≤ –≤—ã–∑–æ–≤–∞—Ö

**"API key not found"**  
- –î–æ–±–∞–≤—å—Ç–µ `OPENAI_API_KEY` –≤ –°–≤–æ–π—Å—Ç–≤–∞ —Å–∫—Ä–∏–ø—Ç–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ PropertiesService

**"Sheet not found"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤ –≤ `_Config.gs`  
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å—Ö–æ–¥–Ω—ã–µ –ª–∏—Å—Ç—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç

**GPT –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å OpenAI –∞–∫–∫–∞—É–Ω—Ç–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –º–æ–¥–µ–ª—å –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
–í—Å–µ –æ—à–∏–±–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ª–∏—Å—Ç `LOG`:
```javascript
logToSheet(ss, '–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ', 'ERROR');
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏—Å—Ç `LOG` –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ `_Config.gs`  
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å Apps Script –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

**–í–µ—Ä—Å–∏—è**: 2.0  
**–î–∞—Ç–∞**: –ê–≤–≥—É—Å—Ç 2025  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: Google Apps Script, Google Sheets
