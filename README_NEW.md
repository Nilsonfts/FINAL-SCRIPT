# üöÄ FINAL-SCRIPT: AMO Analytics System

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –¥–ª—è Google Apps Script —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π AMO CRM.

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
- **–ú–æ–¥—É–ª–µ–π**: 15
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞**: 10,070
- **–í–µ—Ä—Å–∏—è**: 2.0 (–æ—á–∏—â–µ–Ω–Ω–∞—è)
- **–†–∞–∑–º–µ—Ä**: ~1.2 MB

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### üîß –û—Å–Ω–æ–≤–∞ —Å–∏—Å—Ç–µ–º—ã
- `00_–¢–µ—Å—Ç_–°–∏—Å—Ç–µ–º—ã.gs` - –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `01_–ì–ª–∞–≤–Ω—ã–π_–°–∫—Ä–∏–ø—Ç_–ß–ò–°–¢–´–ô.gs` - –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏ –º–µ–Ω—é —Å–∏—Å—Ç–µ–º—ã  
- `02_–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.gs` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –º–∞–ø–ø–∏–Ω–≥–∏
- `03_–û—Å–Ω–æ–≤–Ω—ã–µ_–£—Ç–∏–ª–∏—Ç—ã.gs` - –ë–∞–∑–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### üìà –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏
- `04_–ü–µ—Ä–≤—ã–µ_–ö–∞—Å–∞–Ω–∏—è.gs` - –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤
- `05_–ü—Ä–∏—á–∏–Ω—ã_–û—Ç–∫–∞–∑–æ–≤_AI.gs` - AI-–∞–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω –æ—Ç–∫–∞–∑–æ–≤
- `06_–Ø–Ω–¥–µ–∫—Å_–î–∏—Ä–µ–∫—Ç.gs` - –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç
- `07_–°–∫–≤–æ–∑–Ω–∞—è_–ê–Ω–∞–ª–∏—Ç–∏–∫–∞_–°–∞–π—Ç.gs` - –°–∫–≤–æ–∑–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å–∞–π—Ç–∞
- `08_–°–≤–æ–¥–Ω–∞—è_–ê–Ω–∞–ª–∏—Ç–∏–∫–∞_–ê–ú–û.gs` - –û–±—â–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ CRM
- `09_–Ø–Ω–¥–µ–∫—Å_–ú–µ—Ç—Ä–∏–∫–∞.gs` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–æ–π
- `10_–ú–µ—Å—è—á–Ω—ã–π_–î–∞—à–±–æ—Ä–¥.gs` - –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –º–µ—Å—è—á–Ω—ã–π –æ—Ç—á–µ—Ç
- `11_–ê–Ω–∞–ª–∏–∑_–ö–∞–Ω–∞–ª–æ–≤.gs` - –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤

### üõ†Ô∏è –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏
- `12_–°–∏—Å—Ç–µ–º–Ω—ã–µ_–£—Ç–∏–ª–∏—Ç—ã.gs` - –°–∏—Å—Ç–µ–º–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- `13_–ê–Ω–∞–ª–∏–∑_–°—Ç–∞—Ç—É—Å–æ–≤.gs` - **–ù–û–í–´–ô**: –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–¥–µ–ª–æ–∫
- `14_–ê–Ω–∞–ª–∏–∑_–ö–æ–ª–ª—Ç—Ä–µ–∫–∏–Ω–≥–∞.gs` - **–ù–û–í–´–ô**: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–æ–≤ vs –∑–∞—è–≤–æ–∫

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ v2.0

### üìû –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- **–ó–≤–æ–Ω–∫–∏**: –ê–Ω–∞–ª–∏–∑ –ø–æ –Ω–æ–º–µ—Ä–∞–º –∫–æ–ª–ª-—Ç—Ä–µ–∫–∏–Ω–≥–∞ (MANGO)
- **–ó–∞—è–≤–∫–∏**: –ê–Ω–∞–ª–∏–∑ –ø–æ UTM –º–µ—Ç–∫–∞–º —Å —Å–∞–π—Ç–∞
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã**: –î–æ/–ø–æ—Å–ª–µ –∏—é–ª—è 2025 (–Ω–æ–≤–∞—è UTM —Ä–∞–∑–º–µ—Ç–∫–∞)

### üéØ –î–ª—è –±–∞—Ä–∞/—Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- **–°—Ç–∞—Ç—É—Å—ã –æ–ø–ª–∞—Ç—ã**: "–û–ø–ª–∞—á–µ–Ω–æ", "–£—Å–ø–µ—à–Ω–æ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û", "—É—Å–ø–µ—à–Ω–æ –≤ –†–ü"
- **–ú–µ—Ç—Ä–∏–∫–∏**: –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ‚Üí –í–∏–∑–∏—Ç—ã ‚Üí –í—ã—Ä—É—á–∫–∞
- **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–∞—à–±–æ—Ä–¥** —Å KPI –¥–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞

### üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –∫–∞—á–µ—Å—Ç–≤–æ
- –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –≤ –æ—Ç—á–µ—Ç–∞—Ö
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üéÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
1. –û—Ç–∫—Ä–æ–π—Ç–µ Google Sheets —Å –¥–∞–Ω–Ω—ã–º–∏ AMO CRM
2. –í—ã–±–µ—Ä–∏—Ç–µ –º–µ–Ω—é "üöÄ AMO ANALYTICS" 
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ "üìä –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑"

### –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
- **üìû –ó–≤–æ–Ω–∫–∏ vs –ó–∞—è–≤–∫–∏** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–ø–æ—Å–æ–±–∞–º –æ–±—Ä–∞—â–µ–Ω–∏—è
- **üç∫ –î–∞—à–±–æ—Ä–¥ –±–∞—Ä–∞** - –º–µ—Ç—Ä–∏–∫–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞  
- **üìä –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç—É—Å–æ–≤** - –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- **üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **üîß –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- **üìä –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç—É—Å–æ–≤** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç–∞—Ç—É—Å–æ–≤

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (A-AO)

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
- **A**: –°–¥–µ–ª–∫–∞.ID (–ø–æ–¥—Å—á–µ—Ç –ª–∏–¥–æ–≤)
- **C**: –°–¥–µ–ª–∫–∞.–°—Ç–∞—Ç—É—Å (—É—Å–ø–µ—à–Ω–æ/–Ω–µ—É—Å–ø–µ—à–Ω–æ) 
- **G**: –°–¥–µ–ª–∫–∞.–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π (–º–µ–Ω–µ–¥–∂–µ—Ä –û–ë)
- **I**: –°–¥–µ–ª–∫–∞.–ë—é–¥–∂–µ—Ç (–ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞)
- **P**: –°—á–µ—Ç —Ñ–∞–∫—Ç (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –≤—ã—Ä—É—á–∫–∞)

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞  
- **M**: MANGO –ª–∏–Ω–∏—è (–∫–æ–ª–ª-—Ç—Ä–µ–∫–∏–Ω–≥, –∑–≤–æ–Ω–∫–∏)
- **AB**: UTM_SOURCE (–∑–∞—è–≤–∫–∏ —Å —Å–∞–π—Ç–∞)
- **X**: R.–ò—Å—Ç–æ—á–Ω–∏–∫ —Å–¥–µ–ª–∫–∏ (–¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö)

## üé® –ö–æ–ª–ª-—Ç—Ä–µ–∫–∏–Ω–≥ –º–∞–ø–ø–∏–Ω–≥

| –ù–æ–º–µ—Ä | –ò—Å—Ç–æ—á–Ω–∏–∫ | –¢–∏–ø |
|-------|----------|-----|
| 78123172353 | –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç | üìû –ó–≤–æ–Ω–∫–∏ |
| 78122428017 | –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã | üìû –ó–≤–æ–Ω–∫–∏ |
| 78122709071 | –†–µ—Å—Ç–æ–∫–ª–∞–± | üìû –ó–≤–æ–Ω–∫–∏ |
| 78123177149 | 2–ì–∏—Å | üìû –ó–≤–æ–Ω–∫–∏ |
| 78123177310 | –°–æ—Ü —Å–µ—Ç–∏ + Google | üìû –ó–≤–æ–Ω–∫–∏ |

## üåê UTM –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (—Å –∏—é–ª—è 2025)

| UTM | –ò—Å—Ç–æ—á–Ω–∏–∫ | –¢–∏–ø |
|-----|----------|-----|
| 2gis | 2–ì–∏—Å | üìù –ó–∞—è–≤–∫–∏ |
| geoadv_maps | –ü–æ–∏—Å–∫ –Ω–∞ –∫–∞—Ä—Ç–∞—Ö | üìù –ó–∞—è–≤–∫–∏ |
| telegram | Telegram | üìù –ó–∞—è–≤–∫–∏ |
| vk | –í–ö–æ–Ω—Ç–∞–∫—Ç–µ | üìù –ó–∞—è–≤–∫–∏ |
| ya_map | –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã | üìù –ó–∞—è–≤–∫–∏ |
| yandex | –Ø–Ω–¥–µ–∫—Å –î–∏—Ä–µ–∫—Ç | üìù –ó–∞—è–≤–∫–∏ |

## üèÜ –°—Ç–∞—Ç—É—Å—ã —É—Å–ø–µ—Ö–∞ (–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ)

```
‚úÖ –û–ø–ª–∞—á–µ–Ω–æ
‚úÖ –£—Å–ø–µ—à–Ω–æ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û  
‚úÖ —É—Å–ø–µ—à–Ω–æ –≤ –†–ü
‚úÖ –ó–∞–∫—Ä—ã—Ç–æ –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
‚úÖ –ü—Ä–æ–¥–∞–Ω–æ
‚úÖ –ü—Ä–∏—à–µ–ª
‚úÖ –°–æ—Å—Ç–æ—è–ª–æ—Å—å
```

## üìà –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ
- `runCompleteAnalysis()` - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
- `createBarDashboard()` - –¥–∞—à–±–æ—Ä–¥ –¥–ª—è –±–∞—Ä–∞
- `analyzeContactMethods()` - –∑–≤–æ–Ω–∫–∏ vs –∑–∞—è–≤–∫–∏
- `analyzeAllStatuses()` - –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ  
- `diagnoseWorkingAmoStructure()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- `validateWorkingAmoSheet()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –ª–∏—Å—Ç–∞
- `checkStatus(status)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞

### –£—Ç–∏–ª–∏—Ç—ã
- `getContactMethodAndSource(row)` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è
- `isSuccessStatus(status)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
- `formatCurrency(value)` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç—ã

## üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### v2.0 - –û—á–∏—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
- ‚ùå –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –º–æ–¥—É–ª–∏ (6 —Ñ–∞–π–ª–æ–≤)
- üîÑ –ü–µ—Ä–µ–Ω—É–º–µ—Ä–æ–≤–∞–Ω—ã —Ñ–∞–π–ª—ã –¥–ª—è –ª–æ–≥–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã  
- ‚ûñ –£–±—Ä–∞–Ω–æ 2,994 —Å—Ç—Ä–æ–∫–∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∫–æ–¥–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –º–æ–¥—É–ª–∏ –∞–Ω–∞–ª–∏–∑–∞

### v1.0 - –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
- ‚úÖ 21 –º–æ–¥—É–ª—å, 13,064 —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞
- ‚úÖ –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å AMO –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

## üìû –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É: **üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã**
2. –ò—Å–ø—Ä–∞–≤—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É: **üîß –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É**  
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å—ã: **üìä –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç—É—Å–æ–≤**

---
*–°–æ–∑–¥–∞–Ω–æ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞ üç∫*
