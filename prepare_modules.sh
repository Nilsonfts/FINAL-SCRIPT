#!/bin/bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Google Apps Script

echo "üöÄ –ü–û–î–ì–û–¢–û–í–ö–ê –ú–û–î–£–õ–ï–ô –î–õ–Ø GOOGLE APPS SCRIPT"
echo "=============================================="
echo ""

# –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –≥–æ—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
mkdir -p ready_modules

# –°–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
declare -A modules=(
    ["01_–ì–ª–∞–≤–Ω—ã–π_–°–∫—Ä–∏–ø—Ç.gs"]="üéØ –ì–ª–∞–≤–Ω—ã–π –°–∫—Ä–∏–ø—Ç - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è"
    ["02_–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.gs"]="‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã –∏ API –∫–ª—é—á–∏"
    ["03_–û—Å–Ω–æ–≤–Ω—ã–µ_–£—Ç–∏–ª–∏—Ç—ã.gs"]="üîß –û—Å–Ω–æ–≤–Ω—ã–µ –£—Ç–∏–ª–∏—Ç—ã - –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏"
    ["04_–£—Ç–∏–ª–∏—Ç—ã_–î–∞—Ç.gs"]="üìÖ –£—Ç–∏–ª–∏—Ç—ã –î–∞—Ç - –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏"
    ["05_–£—Ç–∏–ª–∏—Ç—ã_–ó–∞–≥–æ–ª–æ–≤–∫–æ–≤.gs"]="üìù –£—Ç–∏–ª–∏—Ç—ã –ó–∞–≥–æ–ª–æ–≤–∫–æ–≤ - –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö"
    ["06_–£—Ç–∏–ª–∏—Ç—ã_UTM.gs"]="üîó –£—Ç–∏–ª–∏—Ç—ã UTM - –ê–Ω–∞–ª–∏–∑ UTM –º–µ—Ç–æ–∫"
    ["07_–ó–∞–≥—Ä—É–∑–∫–∞_–î–∞–Ω–Ω—ã—Ö.gs"]="üì• –ó–∞–≥—Ä—É–∑–∫–∞ –î–∞–Ω–Ω—ã—Ö - –ò–º–ø–æ—Ä—Ç –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤"
    ["08_–ê–Ω–∞–ª–∏–∑_–ö–∞–Ω–∞–ª–æ–≤.gs"]="üìä –ê–Ω–∞–ª–∏–∑ –ö–∞–Ω–∞–ª–æ–≤ - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç—Ä–∞—Ñ–∏–∫–∞"
    ["09_–ê–Ω–∞–ª–∏–∑_–õ–∏–¥–æ–≤.gs"]="üë• –ê–Ω–∞–ª–∏–∑ –õ–∏–¥–æ–≤ - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–∏–¥–æ–≤"
    ["10_UTM_–ê–Ω–∞–ª–∏—Ç–∏–∫–∞.gs"]="üìà UTM –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ - –î–µ—Ç–∞–ª—å–Ω–∞—è UTM –∞–Ω–∞–ª–∏—Ç–∏–∫–∞"
    ["11_–ü–µ—Ä–≤—ã–µ_–ö–∞—Å–∞–Ω–∏—è.gs"]="üéØ –ü–µ—Ä–≤—ã–µ –ö–∞—Å–∞–Ω–∏—è - –ê–Ω–∞–ª–∏–∑ –∫–∞—Å–∞–Ω–∏–π"
    ["12_–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è_–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.gs"]="üìä –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - –î–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã"
    ["13_–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å_–ú–µ–Ω–µ–¥–∂–µ—Ä–æ–≤.gs"]="üë®‚Äçüíº –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ú–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ - –ê–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç—ã"
    ["14_–°—Ä–∞–≤–Ω–µ–Ω–∏–µ_–ú–µ—Å—è—Ü–µ–≤.gs"]="üìÖ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ú–µ—Å—è—Ü–µ–≤ - –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑"
    ["15_–°–≤–æ–¥–∫–∞_AmoCRM.gs"]="üíº –°–≤–æ–¥–∫–∞ AmoCRM - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AmoCRM"
    ["16_–ê–Ω–∞–ª–∏–∑_–û—Ç–∫–∞–∑–æ–≤.gs"]="‚ùå –ê–Ω–∞–ª–∏–∑ –û—Ç–∫–∞–∑–æ–≤ - –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω –æ—Ç–∫–∞–∑–æ–≤"
)

echo "üìÇ –°–æ–∑–¥–∞—é –≥–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ ready_modules/"
echo ""

counter=1
total_lines=0

for file in $(ls *_*.gs | sort -V); do
    if [ -f "$file" ]; then
        lines=$(wc -l < "$file")
        total_lines=$((total_lines + lines))
        
        echo "[$counter/16] ${modules[$file]}"
        echo "           –§–∞–π–ª: $file"
        echo "           –†–∞–∑–º–µ—Ä: $lines —Å—Ç—Ä–æ–∫"
        
        # –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª –≤ –≥–æ—Ç–æ–≤—É—é –ø–∞–ø–∫—É —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
        cat > "ready_modules/${file}" << EOF
/**
 * ${modules[$file]}
 * 
 * –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –£–°–¢–ê–ù–û–í–ö–ï:
 * 1. –û—Ç–∫—Ä–æ–π—Ç–µ Google Apps Script: https://script.google.com/d/1u77EB0EuYkyO21LhwjVjLJOgHy_dyHZ7TL0rc8yAbbsuLRZG20l0vfUH/edit
 * 2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª: + ‚Üí Script file
 * 3. –ù–∞–∑–æ–≤–∏—Ç–µ —Ñ–∞–π–ª: ${file%.*} (–±–µ–∑ .gs)
 * 4. –£–¥–∞–ª–∏—Ç–µ –≤–µ—Å—å –∫–æ–¥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
 * 5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ –Ω–∏–∂–µ
 * 6. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª (Ctrl+S)
 */

EOF
        
        # –î–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥
        cat "$file" >> "ready_modules/${file}"
        
        echo "           ‚úÖ –ì–æ—Ç–æ–≤: ready_modules/$file"
        echo ""
        
        counter=$((counter + 1))
    fi
done

echo "üéâ –ü–û–î–ì–û–¢–û–í–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê!"
echo "========================"
echo "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:"
echo "   ‚Ä¢ –ú–æ–¥—É–ª–µ–π: 16"
echo "   ‚Ä¢ –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä: $total_lines —Å—Ç—Ä–æ–∫"
echo "   ‚Ä¢ –ì–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã: ready_modules/"
echo ""
echo "üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://script.google.com/d/1u77EB0EuYkyO21LhwjVjLJOgHy_dyHZ7TL0rc8yAbbsuLRZG20l0vfUH/edit"
echo "2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ ready_modules/:"
echo "   ‚Ä¢ –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Script file –≤ Google Apps Script"
echo "   ‚Ä¢ –ù–∞–∑–æ–≤–∏—Ç–µ —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ —Ñ–∞–π–ª–µ"
echo "   ‚Ä¢ –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –∫–æ–¥ –∏–∑ –≥–æ—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞"
echo "3. –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π –∑–∞–ø—É—Å—Ç–∏—Ç–µ initializeSystem()"
echo ""
echo "üí° –°–æ–≤–µ—Ç: –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª ready_modules/01_–ì–ª–∞–≤–Ω—ã–π_–°–∫—Ä–∏–ø—Ç.gs –∏ –Ω–∞—á–Ω–∏—Ç–µ —Å –Ω–µ–≥–æ!"

# –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–µ–∫—Å–Ω—ã–π —Ñ–∞–π–ª —Å–æ –≤—Å–µ–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏
cat > ready_modules/README.md << EOF
# üöÄ –ì–æ—Ç–æ–≤—ã–µ –ú–æ–¥—É–ª–∏ –¥–ª—è Google Apps Script

## –ü—Ä–æ–µ–∫—Ç ID
\`1u77EB0EuYkyO21LhwjVjLJOgHy_dyHZ7TL0rc8yAbbsuLRZG20l0vfUH\`

## –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç
https://script.google.com/d/1u77EB0EuYkyO21LhwjVjLJOgHy_dyHZ7TL0rc8yAbbsuLRZG20l0vfUH/edit

## –ü–æ—Ä—è–¥–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–æ–¥—É–ª–µ–π

EOF

for file in $(ls *_*.gs | sort -V); do
    if [ -f "$file" ]; then
        echo "### ${file%.*}" >> ready_modules/README.md
        echo "- –§–∞–π–ª: \`ready_modules/$file\`" >> ready_modules/README.md
        echo "- –û–ø–∏—Å–∞–Ω–∏–µ: ${modules[$file]}" >> ready_modules/README.md
        echo "- –ö–æ–º–∞–Ω–¥–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: \`cat ready_modules/$file\`" >> ready_modules/README.md
        echo "" >> ready_modules/README.md
    fi
done

cat >> ready_modules/README.md << EOF

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ Google Apps Script –ø—Ä–æ–µ–∫—Ç –ø–æ —Å—Å—ã–ª–∫–µ –≤—ã—à–µ
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è:
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Script file (+ ‚Üí Script file)
   - –ù–∞–∑–æ–≤–∏—Ç–µ —Ñ–∞–π–ª —Å–æ–≥–ª–∞—Å–Ω–æ –∏–º–µ–Ω–∏ –º–æ–¥—É–ª—è (–±–µ–∑ .gs)
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –≥–æ—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
   - –í—Å—Ç–∞–≤—å—Ç–µ –≤ Google Apps Script
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ (Ctrl+S)
3. –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é \`initializeSystem()\`

## –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–ú–æ–¥—É–ª–µ–π**: 16
- **–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä**: $total_lines —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- **–Ø–∑—ã–∫**: Google Apps Script (JavaScript)
EOF

echo "üìÑ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª: ready_modules/README.md —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π"
